#!/bin/bash

echo "­ЪћЦ жќІуЎ║сѓхсЃ╝сЃљсЃ╝сѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."

# Docker сѓхсЃ╝сЃЊсѓ╣сѓњУхитІЋ
echo "­Ъљ│ сЃЄсЃ╝сѓ┐сЃЎсЃ╝сѓ╣сЂеRedisсѓњУхитІЋСИГ..."
cd docker
docker-compose -f docker-compose.dev.yml up -d

cd ..

# сЃљсЃЃсѓ»сѓесЃ│сЃЅсЂесЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњСИдтѕЌсЂДУхитІЋ
echo "­Ъџђ сЃљсЃЃсѓ»сѓесЃ│сЃЅсЂесЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋСИГ..."

# сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓњУхитІЋ (сЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅ)
cd backend
air &
BACKEND_PID=$!

# сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋ (сЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅ)
cd ../frontend
npm run dev &
FRONTEND_PID=$!

echo "РюЁ жќІуЎ║сѓхсЃ╝сЃљсЃ╝сЂїУхитІЋсЂЌсЂЙсЂЌсЂЪ№╝Ђ"
echo ""
echo "­Ъїљ сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅ: http://localhost:3000"
echo "­ЪћЌ API: http://localhost:8080"
echo "­ЪЊі у«Ауљєућ╗жЮб: http://localhost:3000/admin"
echo ""
echo "тЂюТГбсЂЎсѓІсЂФсЂ» Ctrl+C сѓњТі╝сЂЌсЂдсЂЈсЂасЂЋсЂё"

# сѓисѓ░сЃісЃФсЃЈсЃ│сЃЅсЃфсЃ│сѓ░
trap 'kill $BACKEND_PID $FRONTEND_PID; exit' INT

# сЃЌсЃГсѓ╗сѓ╣сЂ«т«їС║єсѓњтЙЁсЂц
wait